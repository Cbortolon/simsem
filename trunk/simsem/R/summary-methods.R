# summary
# Methods -- simsem package
# Provide description of an object
# Generic Function: summary(object, ...)
# Argument:
#	object: The target object that is used to summarize
# 	... : Other arguments (None is specified currently)
# Author: Sunthud Pornprasertmanit (University of Kansas; psunthud@ku.edu)
# Date Modified: October 6, 2011

setMethod("summary",
    signature(object = "SimNorm"),
    function (object)
    {
		print("Random Normal Distribution Object.")
		print(paste("mean is ", format(object@mean, digits=3), ".", sep=""))
		print(paste("Standard deviation is ", format(object@sd, digits=3), ".", sep=""))
    }
)
#Arguments: 
#	object:	SimNorm.c that users wish to summarize
#Description: This function will print all attributes of an object
#Return: 	NONE. Results will print on screen only.

setMethod("summary",
    signature(object = "SimUnif"),
    function (object) 
    {
		print("Random Uniform Distribution Object.")
		print(paste("min bound is ", format(object@min, digits=3), ".", sep=""))
		print(paste("max bound is ", format(object@max, digits=3), ".", sep=""))
    }
)
#Arguments: 
#	object:	SimUnif.c that users wish to summarize
#Description: This function will print all attributes of an object
#Return: 	NONE. Results will print on screen only.

setMethod("summary", signature="SimMatrix", definition = function(object) {
		print("Random Full Matrix Object.")
		print("Free/Fixed Parameters:")
		print(object@free)
		print("Parameter/Starting Values:")
		print(object@param)
	}	
)
#Arguments: 
#	object:	SimMatrix.c that users wish to summarize
#Description: This function will print free/fixed parameters and parameter/starting values.
#Return: 	NONE. Results will print on screen only.

setMethod("summary", signature="SymMatrix", definition = function(object) {
		print("Random Symmetric Matrix Object.")
		print("Free/Fixed Parameters:")
		print(object@free)
		print("Parameter/Starting Values:")
		print(object@param)
	}	
)
#Arguments: 
#	object:	SymMatrix.c that users wish to summarize
#Description: This function will print free/fixed parameters and parameter/starting values.
#Return: 	NONE. Results will print on screen only.

setMethod("summary", signature="SimVector", definition = function(object) {
		print("Random Vector Object.")
		print("Free/Fixed Parameters:")
		print(object@free)
		print("Parameter/Starting Values:")
		print(object@param)
	}	
)
#Arguments: 
#	object:	SimVector.c that users wish to summarize
#Description: This function will print free/fixed parameters and parameter/starting values.
#Return: 	NONE. Results will print on screen only.

setMethod("summary", signature="SimSet", definition= function(object) {
		cat("SET OF MODEL MATRICES\n")
		cat("Type\n")
		print(object@modelType)
		cat("-- Endogeneous Variable --\n")
		print.if.not.null(object@LY, "\nLY: Loading of Indicator.Y on Factor.ETA")
		print.if.not.null(object@VTE, "\nVTE: Variance of Measurement.Error.EPSILON")
		print.if.not.null(object@TE, "\nTE: Correlation of Measurement.Error.EPSILON")
		print.if.not.null(object@VY, "\nVY: Variance of Indicator.Y")
		print.if.not.null(object@TY, "\nTY: Measurement Intercept of Indicator.Y")
		print.if.not.null(object@MY, "\nMY: mean of Indicator.Y")
		print.if.not.null(object@BE, "\nBE: Regression Coefficient among Factor.ETA")
		print.if.not.null(object@VPS, "\nVPS: Variance of Regression.Residual.PSI")
		print.if.not.null(object@PS, "\nPS: Correlation of Regression.Residual.PSI")
		print.if.not.null(object@VE, "\nVE: Variance of Factor.ETA")
		print.if.not.null(object@AL, "\nAL: Regression Intercept of Factor.ETA")
		print.if.not.null(object@ME, "\nME: mean of Factor.ETA")
		cat("-------------------------------------------------", "\n")
		cat("-- Exogeneous Variable --\n")
		#browser()
		print.if.not.null(object@LX, "\nLX: Loading of Indicator.X on Factor.KSI")
		print.if.not.null(object@VTD, "\nVTD: Variance of Measurement.Error.DELTA")
		print.if.not.null(object@TD, "\nTD: Correlation of Measurement.Error.DELTA")
		print.if.not.null(object@VX, "\nVX: Variance of Indicator.X")
		print.if.not.null(object@TX, "\nTX: Measurement Intercept of Indicator.X")
		print.if.not.null(object@MX, "\nMX: mean of Indicator.X")
		print.if.not.null(object@GA, "\nGA: Regression Coefficient of Factor.ETA on Factor.KSI")
		print.if.not.null(object@VPH, "\nVPH: Variance of Factor.KSI")
		print.if.not.null(object@PH, "\nPH: Correlation of Factor.KSI")
		print.if.not.null(object@KA, "\nKA: mean of Factor.KSI")
		print.if.not.null(object@TH, "\nTH: Correlation of Measurement.Error.DELTA and Measurement.Error.EPSILON")
		cat("-------------------------------------------------", "\n")
	}
)
#Arguments: 
#	object:	SimSet.c that users wish to summarize
#Description: This function will print every object that is not null in the model in short format (summary.short).
#Return: 	NONE. Results will print on screen only.

setMethod("summary", signature="SimEqualCon", definition=function(object){
	cat("CONSTRAINT OBJECT\n")
	cat("Type\n")
	print(object@modelType)
	cat("-------------Constraint----------------\n")
	for(i in 1:length(object@con)) {
		cat(i, ".\n", sep="")
		print(object@con[[i]])
		cat("---------------------------------------\n")
	}
})
#Arguments: 
#	object:	SimEqualCon.c that users wish to summarize
#Description: This function will print all constraints in the model.
#Return: 	NONE. Results will print on screen only.

setMethod("summary", signature="MatrixSet", definition=function(object) {
		cat("RANDOM NUMBERS OF MODEL MATRICES\n")
		cat("Type\n")
		print(object@modelType)		
		cat("-- Endogeneous Variable --\n")
		print.if.not.null(object@LY, "\nLY: Loading of Indicator.Y on Factor.ETA")
		print.if.not.null(object@VTE, "\nVTE: Variance of Measurement.Error.EPSILON")
		print.if.not.null(object@TE, "\nTE: Correlation of Measurement.Error.EPSILON")
		print.if.not.null(object@VY, "\nVY: Variance of Indicator.Y")
		print.if.not.null(object@TY, "\nTY: Measurement Intercept of Indicator.Y")
		print.if.not.null(object@MY, "\nMY: mean of Indicator.Y")
		print.if.not.null(object@BE, "\nBE: Regression Coefficient among Factor.ETA")
		print.if.not.null(object@VPS, "\nVPS: Variance of Regression.Residual.PSI")
		print.if.not.null(object@PS, "\nPS: Correlation of Regression.Residual.PSI")
		print.if.not.null(object@VE, "\nVE: Variance of Factor.ETA")
		print.if.not.null(object@AL, "\nAL: Regression Intercept of Factor.ETA")
		print.if.not.null(object@ME, "\nME: mean of Factor.ETA")
		cat("-------------------------------------------------", "\n")
		cat("-- Exogeneous Variable --\n")
		print.if.not.null(object@LX, "\nLX: Loading of Indicator.X on Factor.KSI")
		print.if.not.null(object@VTD, "\nVTD: Variance of Measurement.Error.DELTA")
		print.if.not.null(object@TD, "\nTD: Correlation of Measurement.Error.DELTA")
		print.if.not.null(object@VX, "\nVX: Variance of Indicator.X")
		print.if.not.null(object@TX, "\nTX: Measurement Intercept of Indicator.X")
		print.if.not.null(object@MX, "\nMX: mean of Indicator.X")
		print.if.not.null(object@GA, "\nGA: Regression Coefficient of Factor.ETA on Factor.KSI")
		print.if.not.null(object@VPH, "\nVPH: Variance of Factor.KSI")
		print.if.not.null(object@PH, "\nPH: Correlation of Factor.KSI")
		print.if.not.null(object@KA, "\nKA: mean of Factor.KSI")
		print.if.not.null(object@TH, "\nTH: Correlation of Measurement.Error.DELTA and Measurement.Error.EPSILON")
		cat("-------------------------------------------------", "\n")
	}
)
#Arguments: 
#	object:	MatrixSet.c that users wish to summarize
#Description: This function will print all matrices or vectors in the MatrixSet.c if not NULL.
#Return: 	NONE. Results will print on screen only.

setMethod("summary", signature="SimFreeParam", definition=function(object) {
		cat("SET OF ESTIMATED PARAMETERS\n")
		cat("Type\n")
		print(object@modelType)		
		cat("-- Endogeneous Variable --\n")
		print.if.not.null(object@LY, "\nLY: Loading of Indicator.Y on Factor.ETA")
		print.if.not.null(object@TE, "\nTE: Correlation of Measurement.Error.EPSILON")
		print.if.not.null(object@TY, "\nTY: Measurement Intercept of Indicator.Y")
		print.if.not.null(object@BE, "\nBE: Regression Coefficient among Factor.ETA")
		print.if.not.null(object@PS, "\nPS: Correlation of Regression.Residual.PSI")
		print.if.not.null(object@AL, "\nAL: Regression Intercept of Factor.ETA")
		cat("-------------------------------------------------", "\n")
		cat("-- Exogeneous Variable --\n")
		print.if.not.null(object@LX, "\nLX: Loading of Indicator.X on Factor.KSI")
		print.if.not.null(object@TD, "\nTD: Correlation of Measurement.Error.DELTA")
		print.if.not.null(object@TX, "\nTX: Measurement Intercept of Indicator.X")
		print.if.not.null(object@GA, "\nGA: Regression Coefficient of Factor.ETA on Factor.KSI")
		print.if.not.null(object@PH, "\nPH: Correlation of Factor.KSI")
		print.if.not.null(object@KA, "\nKA: mean of Factor.KSI")
		print.if.not.null(object@TH, "\nTH: Correlation of Measurement.Error.DELTA and Measurement.Error.EPSILON")
		cat("-------------------------------------------------", "\n")
	}
)
#Arguments: 
#	object:	SimFreeParam.c that users wish to summarize
#Description: This function will print all matrices or vectors in the SimFreeParam.c if not NULL.
#Return: 	NONE. Results will print on screen only.

setMethod("summary", signature="SimLabels", definition=function(object) {
		cat("SET OF ESTIMATED PARAMETERS\n")
		cat("Type\n")
		print(object@modelType)		
		cat("-- Endogeneous Variable --\n")
		print.if.not.null(object@LY, "\nLY: Loading of Indicator.Y on Factor.ETA")
		print.if.not.null(object@TE, "\nTE: Correlation of Measurement.Error.EPSILON")
		print.if.not.null(object@TY, "\nTY: Measurement Intercept of Indicator.Y")
		print.if.not.null(object@BE, "\nBE: Regression Coefficient among Factor.ETA")
		print.if.not.null(object@PS, "\nPS: Correlation of Regression.Residual.PSI")
		print.if.not.null(object@AL, "\nAL: Regression Intercept of Factor.ETA")
		cat("-------------------------------------------------", "\n")
		cat("-- Exogeneous Variable --\n")
		print.if.not.null(object@LX, "\nLX: Loading of Indicator.X on Factor.KSI")
		print.if.not.null(object@TD, "\nTD: Correlation of Measurement.Error.DELTA")
		print.if.not.null(object@TX, "\nTX: Measurement Intercept of Indicator.X")
		print.if.not.null(object@GA, "\nGA: Regression Coefficient of Factor.ETA on Factor.KSI")
		print.if.not.null(object@PH, "\nPH: Correlation of Factor.KSI")
		print.if.not.null(object@KA, "\nKA: mean of Factor.KSI")
		print.if.not.null(object@TH, "\nTH: Correlation of Measurement.Error.DELTA and Measurement.Error.EPSILON")
		cat("-------------------------------------------------", "\n")
	}
)
#Arguments: 
#	object:	SimLabels.c that users wish to summarize
#Description: This function will print all matrices or vectors in the SimLabels.c if not NULL.
#Return: 	NONE. Results will print on screen only.

setMethod("summary", signature="SimRSet", definition=function(object) {
		cat("RANDOM NUMBERS OF MODEL MATRICES\n")
		cat("Type\n")
		print(object@modelType)		
		cat("-- Endogeneous Variable --\n")
		print.if.not.null(object@LY, "\nLY: Loading of Indicator.Y on Factor.ETA")
		print.if.not.null(object@TE, "\nTE: Correlation of Measurement.Error.EPSILON")
		print.if.not.null(object@TY, "\nTY: Measurement Intercept of Indicator.Y")
		print.if.not.null(object@BE, "\nBE: Regression Coefficient among Factor.ETA")
		print.if.not.null(object@PS, "\nPS: Correlation of Regression.Residual.PSI")
		print.if.not.null(object@AL, "\nAL: Regression Intercept of Factor.ETA")
		cat("-------------------------------------------------", "\n")
		cat("-- Exogeneous Variable --\n")
		print.if.not.null(object@LX, "\nLX: Loading of Indicator.X on Factor.KSI")
		print.if.not.null(object@TD, "\nTD: Correlation of Measurement.Error.DELTA")
		print.if.not.null(object@TX, "\nTX: Measurement Intercept of Indicator.X")
		print.if.not.null(object@GA, "\nGA: Regression Coefficient of Factor.ETA on Factor.KSI")
		print.if.not.null(object@PH, "\nPH: Correlation of Factor.KSI")
		print.if.not.null(object@KA, "\nKA: mean of Factor.KSI")
		print.if.not.null(object@TH, "\nTH: Correlation of Measurement.Error.DELTA and Measurement.Error.EPSILON")
		cat("-------------------------------------------------", "\n")
	}
)
#Arguments: 
#	object:	SimRSet.c that users wish to summarize
#Description: This function will print all matrices or vectors in the SimRSet.c if not NULL.
#Return: 	NONE. Results will print on screen only.

setMethod("summary", signature="SimData", definition=function(object, detail=FALSE) {
		cat("DATA OBJECT\n")
		cat("Type\n")
		print(object@modelType)
		cat("Sample Size\n")
		print(object@N)
		cat("========= Parameters Set ============\n")
		summary(object@Parameters)
		cat("Number of free parameters = ", count.random.object(object@Parameters), "\n")
		cat("=====================================\n")
		if(detail) {
			cat("============Misspecified Set================\n")
			ifelse(!is.null.object(object@Misspecified), summary(object@Misspecified), print("None"))
			cat("============================================\n")
			cat("=============Constraint=====================\n")
			ifelse(!is.null.object(object@Constraint), summary(object@SimEqualCon), print("None"))
			cat("============================================\n")
		} else {
			cat("Adding Misspecification?\n")
			ifelse(!is.null.object(object@Misspecified), print("Yes"), print("No"))
			cat("Adding Constraint?\n")
			ifelse(!is.null.object(object@Constraint), print("Yes"), print("No"))
		}
		if(!is.null.object(object@Misspecified) & !is.null.object(object@Constraint)) {
			cat("Constain objects BEFORE or AFTER adding misspecification\n")
			ifelse(object@Constrain.Parameters.Only, print("Before"), print("After"))
		}
		if(!is.null.object(object@Misspecified)) {
			cat("Misfit bound\n")
			if(!is.null.object(object@Misfit.bound)) {
				print(paste("min =", object@Misfit.bound[1]))
				print(paste("max =", object@Misfit.bound[2]))
			} else {
				print("No")
			}
		}
		cat("Maximum Random Sampling Parameters\n")
		print(object@Maximum.random)
	}
)
#Arguments: 
#	object:	SimData.c that users wish to summarize
#Description: This function will print all elements in the SimData.c.
#Return: 	NONE. Results will print on screen only.

setMethod("summary", signature="SimModel", definition=function(object, detail.constraint=FALSE, starting.values=FALSE) {
		cat("MODEL OBJECT\n")
		cat("Type\n")
		print(object@modelType)
		cat("========= Parameters Set ============\n")
		summary(object@Parameters)
		cat("Number of free parameters = ", count.random.object(object@Parameters), "\n")
		cat("=====================================\n")
		if(starting.values) {
			cat("============Starting Values================\n")
			ifelse(!is.null.object(object@Starting.Values), summary(object@Starting.Values), print("None"))
			cat("============================================\n")		
		}
		if(detail.constraint) {
			cat("=============Constraint=====================\n")
			ifelse(!is.null.object(object@Constraint), summary(object@SimEqualCon), print("None"))
			cat("============================================\n")
		} else {
			cat("Adding Constraint?\n")
			ifelse(!is.null.object(object@Constraint), print("Yes"), print("No"))
		}
		cat("Analysis Package\n")
		print(object@Program)
	}
)
#Arguments: 
#	object:	SimModel.c that users wish to summarize
#Description: This function will print all elements in the SimModel.c.
#Return: 	NONE. Results will print on screen only.

setMethod("summary", signature="SimResult", definition=function(object) {
		cat("RESULT OBJECT\n")
		cat("Type\n")
		print(object@modelType)
		cat("========= Fit Indices Cutoffs ============\n")
		alpha <- c(0.10, 0.05, 0.01, 0.001)
		cutoffs <- round(sapply(alpha, getCutoff, object=object), 3)
		colnames(cutoffs) <- alpha
		names(dimnames(cutoffs)) <- c("Fit Indices", "Alpha")
		print(cutoffs)
		cat("Number of Replications\n")
		print(object@Replication)
		cat("Number of Convergent Replications\n")
		print(object@Convergence)
	}
)
#Arguments: 
#	object:	SimResult.c that users wish to summarize
#Description: This function will print all elements in the SimResult.c.
#Return: 	NONE. Results will print on screen only.

setMethod("summary", signature="SimModelOut", definition=function(object) {
		cat("MODEL ANALYSIS RESULT OBJECT\n")
		cat("Fit Indices\n")
		print(object@Fit)
		cat("Convergence\n")
		print(object@Convergence)
	}
)
#Arguments: 
#	object:	SimResult.c that users wish to summarize
#Description: This function will print all elements in the SimResult.c.
#Return: 	NONE. Results will print on screen only.

